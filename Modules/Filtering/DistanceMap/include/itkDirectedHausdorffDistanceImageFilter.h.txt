reviewed

minor changes (move implementation in txx file)
